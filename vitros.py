import json
from classes.parse import Parse
from pymongo import MongoClient


STRING_1 = """
"
H|\\^&|||4600968||||||||LIS2-A|20221207140617\r\u000371\r\n'\nb'\u00021
H|\\^&|||4600968||||||||LIS2-A|20221207140617\r\u000371\r\n'\nb'\u00021
H|\\^&|||4600968||||||||LIS2-A|20221207140617\r\u000371\r\n'\nb'\u00021
H|\\^&|||4600968||||||||LIS2-A|20221207140617\r\u000371\r\n'\nb'\u00021
H|\\^&|||4600968||||||||LIS2-A|20221207140617\r\u000371\r\n'\nb'\u00022
P|1\r\u00033F\r\n'\nb'\u00022P|1\r\u00033F\r\n\u00023
O|1|PV1^19^1||^^^1.0000+300+1.0\\301+1.0\\302+1.0\\303+1.0\\304+1.0\\305+1.0\\306+1.0\\307+1.0'\nb'\\308+1.0\\309+1.0\\310+1.0\\311+1.0\\314+1.0\\315+1.0\\317+1.0\\318+1.0\\319+1.0\\320+1.0\\321+1.0\\323+1.0\\325+1.0\\326+1.0\\327+1.0\\330+1.0\\331+1.0\\356+1.0\\357+1.0\\950+1.0\\951+1.0\\952+1.0|\n
R||||||N||||5||||||||||F\r\u0003B8\r\n'\nb'\u00024\n
R|1|^^^1.0000+300+1.0|81.9|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N\n
R||V|||20221118100216|20221118100828|4600096'\nb'8\r\u000361\r\n'\nb'\u00024\n
R|1|^^^1.0000+300+1.0|81.9|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N\n
R||V|||20221118100216|20221118100828|4600096'\nb'8\r\u000361\r\n'\nb'\u00024\n
R|1|^^^1.0000+300+1.0|81.9|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100828|4600096'\nb'8\r\u000361\r\n'\nb'\u00025
R|2|^^^1.0000+301+1.0|3.49|g/dL||^0^NQ\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100809|460009'\nb'68\r\u000393\r\n'\nb'\u00026
R|3|^^^1.0000+302+1.0|4.04|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100837|4600096'\nb'8\r\u00035D\r\n'\nb'\u00027
R|4|^^^1.0000+303+1.0|2.33|g/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100508|46000968'\nb'\r\u0003EE\r\n'\nb'\u00027
R|4|^^^1.0000+303+1.0|2.33|g/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100508|46000968'\nb'\r\u0003EE\r\n'\nb'\u00020
R|5|^^^1.0000+304+1.0|118.6|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100925|460009'\nb'68\r\u000391\r\n'\nb'\u00021
R|6|^^^1.0000+305+1.0|140.6|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100906|460009'\nb'68\r\u00038E\r\n'\nb'\u00021
R|6|^^^1.0000+305+1.0|140.6|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100906|460009'\nb'68\r\u00038E\r\n'\nb'\u00022
R|7|^^^1.0000+306+1.0|88.4|U/L||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100750|46000968\r'\nb'\u000384\r\n'\nb'\u00023
R|8|^^^1.0000+307+1.0|78.3|mmol/L||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100624|460009'\nb'68\r\u0003E5\r\n'\nb'\u00023
R|8|^^^1.0000+307+1.0|78.3|mmol/L||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100624|460009'\nb'68\r\u0003E5\r\n'\nb'\u00024
R|9|^^^1.0000+308+1.0|3.00|mmol/L||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100643|460009'\nb'68\r\u0003DA\r\n'\nb'\u00025
R|10|^^^1.0000+309+1.0|116.1|mmol/L||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100634|4600'\nb'0968\r\u00033A\r\n'\nb'\u00026
R|11|^^^1.0000+310+1.0|26.5|mmol/L||^A^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100759|46000'\nb'968\r\u000321\r\n'\nb'\u00026
R|11|^^^1.0000+310+1.0|26.5|mmol/L||^A^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100759|46000'\nb'968\r\u000321\r\n'\nb'\u00027
R|12|^^^1.0000+311+1.0|3.53|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100847|460009'\nb'68\r\u000392\r\n'\nb'\u00020
R|13|^^^1.0000+314+1.0|0.975|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100759|46000'\nb'968\r\u0003CB\r\n'\nb'\u00021
R|14|^^^1.0000+315+1.0|39.7|mg/dL(A)||^C^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100818|460'\nb'00968\r\u00033D\r\n'\nb'\u00021
R|14|^^^1.0000+315+1.0|39.7|mg/dL(A)||^C^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100818|460'\nb'00968\r\u00033D\r\n'\nb'\u00022
R|15|^^^1.0000+317+1.0|0.491|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100809|46000'\nb'968\r\u0003C7\r\n'\nb'\u00023
R|16|^^^1.0000+318+1.0|8.08|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100856|460009'\nb'68\r\u00039E\r\n'\nb'\u00024
R|17|^^^1.0000+319+1.0|1.368|mg/dL||^A^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100818|46000'\nb'968\r\u0003E2\r\n'\nb'\u00024
R|17|^^^1.0000+319+1.0|1.368|mg/dL||^A^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100818|46000'\nb'968\r\u0003E2\r\n'\nb'\u00025
R|18|^^^1.0000+320+1.0|31.7|U/L||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100828|46000968'\nb'\r\u0003B2\r\n'\nb'\u00026
R|19|^^^1.0000+321+1.0|92.2|U/L||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100837|46000968'\nb'\r\u0003B7\r\n'\nb'\u00027
R|20|^^^1.0000+323+1.0|166.0|U/L||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100847|4600096'\nb'8\r\u0003E3\r\n'\nb'\u00027
R|20|^^^1.0000+323+1.0|166.0|U/L||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100847|4600096'\nb'8\r\u0003E3\r\n'\nb'\u00020
R|21|^^^1.0000+325+1.0|150.0|U/L||^0^RE\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100856|46000'\nb'968\r\u00036F\r\n'\nb'\u00021
R|22|^^^1.0000+326+1.0|62.8|U/L||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100915|46000968'\nb'\r\u0003B1\r\n'\nb'\u00022
R|23|^^^1.0000+327+1.0|0.178|mg/dL||^A^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100809|46000'\nb'968\r\u0003DA\r\n'\nb'\u00022
R|23|^^^1.0000+327+1.0|0.178|mg/dL||^A^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100809|46000'\nb'968\r\u0003DA\r\n'\nb'\u00023
R|24|^^^1.0000+330+1.0|1.99|mg/dL||^A^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100906|460009'\nb'68\r\u0003A7\r\n'\nb'\u00024
R|25|^^^1.0000+331+1.0|81.5|ug/dL||^0^NQ\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100934|4600'\nb'0968\r\u00033C\r\n'\nb'\u00025
R|26|^^^1.0000+356+1.0|45.5|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100934|460009'\nb'68\r\u00039E\r\n'\nb'\u00025
R|26|^^^1.0000+356+1.0|45.5|mg/dL||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100934|460009'\nb'68\r\u00039E\r\n'\nb'\u00026
R|27|^^^1.0000+357+1.0|28.6|U/L||^0^\\^0^NR\\^0^NR\\^0^N
R||V|||20221118100216|20221118100944|46000968'\nb'\r\u0003C1\r\n'\nb'\u00027
R|28|^^^1.0000+950+1.0|No Result|||^0^N
R||V|||20221118100216|20221118100209|46000968\r\u000362\r\n\u00020
R|29|^'\nb'^^1.0000+951+1.0|No Result|||^0^N
R||V|||20221118100216|20221118100209|46000968\r\u00035D\r\n'\nb'\u00020
R|29|^^^1.0000+951+1.0|No Result|||^0^N
R||V|||20221118100216|20221118100209|46000968\r\u00035D\r\n\u00021
R|30|^'\nb'^^1.0000+952+1.0|No Result|||^0^N
R||V|||20221118100216|20221118100209|46000968\r\u000357\r\n'\nb'\u00022L|1|N\r\u000305\r\n\u0004'\nb''\n"
"""


STRING_2="""
b'\x05'
b'\x021H|\\^&|||4600968||||||||LIS2-A|20221207135825\r\x0376\r\n'
b'\x021H|\\^&|||4600968||||||||LIS2-A|20221207135825\r\x0376\r\n'
b'\x021H|\\^&|||4600968||||||||LIS2-A|20221207135825\r\x0376\r\n'
b'\x021H|\\^&|||4600968||||||||LIS2-A|20221207135825\r\x0376\r\n'
b'\x021H|\\^&|||4600968||||||||LIS2-A|20221207135825\r\x0376\r\n'
b'\x022P|1\r\x033F\r\n'
b'\x022P|1\r\x033F\r\n\x023O|1|CTO22020603^6^2||^^^1.0000+344+3.0\\950+1.0\\951+1.0\\952+1.0|R||||||N||||5||||||||||F'
b'\r\x036D\r\n'
b'\x024R|1|^^^1.0000+344+3.0|224.2|mg/L||^0^REECOD\\^0^NR\\^0^NR\\^0^NR||V|||20221207122245|20221207123406|4'
b'6000968\r\x03E2\r\n'
b'\x024R|1|^^^1.0000+344+3.0|224.2|mg/L||^0^REECOD\\^0^NR\\^0^NR\\^0^NR||V|||20221207122245|20221207123406|4'
b'6000968\r\x03E2\r\n'
b'\x024R|1|^^^1.0000+344+3.0|224.2|mg/L||^0^REECOD\\^0^NR\\^0^NR\\^0^NR||V|||20221207122245|20221207123406|4'
b'6000968\r\x03E2\r\n'
b'\x025R|2|^^^1.0000+950+1.0|15|||^5^||V|||20221207122245|20221207122302|46000968\r\x0399\r\n\x026R|3|^^^1.0000+95'
b'1+1.0|2|||^5^||V|||20221207122245|20221207122302|46000968\r\x0368\r\n'
b'\x027R|4|^^^1.0000+952+1.0|20|||^5^||V|||20221207122245|20221207122302|46000968\r\x039B\r\n\x027R|4|^^^1.0000+95'
b'2+1.0|20|||^5^||V|||20221207122245|20221207122302|46000968\r\x039B\r\n'
b'\x020L|1|N\r\x0303\r\n\x021H|\\^&|||4600968||||||||LIS2-A|20221207135902\r\x0372\r\n'
b'\x022P|1||||RENDON^AURELIA|||M\r\x0317\r\n'
b''
b'\x023O|1|CTO22020506^6^1||^^^1.0000+507+1.0\\950+1.0\\951+1.0\\952+1.0|R||||||N||||5||||||||||F\r\x036D\r\n'
b''
b'\x024R|1|^^^1.0000+507+1.0|45.23|mg/dL||^0^RE\\^0^\\^0^\\^0^||V|||20221207122236|20221207123454|46000968\r\x0351\r\n'
b''
b'\x025R|2|^^^1.0000+950+1.0|15|||^5^||V|||20221207122236|20221207122253|46000968\r\x039E\r\n'
b''
b'\x026R|3|^^^1.0000+951+1.0|2|||^5^||V|||20221207122236|20221207122253|46000968\r\x036D\r\n'
b''
b'\x027R|4|^^^1.0000+952+1.0|20|||^5^||V|||20221207122236|20221207122253|46000968\r\x03A0\r\n'
b''
b'\x020L|1|N\r\x0303\r\n'
b''
b'\x04'

"""

if __name__ == '__main__':
    myclient = MongoClient("mongodb://localhost:27017")
    mydb = myclient["interfaces"]
    mycol = mydb["dna_labs"]
    
    separa = """
    #######################################################################################################
    #                                               Primeras                                              #
    #######################################################################################################
    """
    
    
    
    obj = Parse(cadena=STRING_1,posicion_nim=1,udn='001')
    dd = obj.separa_cadena('vitros')
    # x = mycol.insert_one(dd)
    print(json.dumps(dd, sort_keys=False, indent=4))
    
    
    print("""
          ***************************************************************************
          """)
    
    obj = Parse(cadena=STRING_2,posicion_nim=1,udn='001')
    dd = obj.separa_cadena('vitros')
    # x = mycol.insert_one(dd)
    print(json.dumps(dd, sort_keys=False, indent=4))
    
    
    
    
    